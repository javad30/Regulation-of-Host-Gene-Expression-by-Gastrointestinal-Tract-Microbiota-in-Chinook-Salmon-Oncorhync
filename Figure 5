###Spearman heatmap

require(ggpubr)
require(tidyverse)
require(Hmisc)
require(corrplot)
library("pheatmap")
library(ggpubr)



matrix_a <- Taxa
matrix_b <- Open


bb <- cor(matrix_b, matrix_a, method = "spearman", use = "pairwise.complete.obs")
nba_matrix <- data.matrix(bb)

pheatmap(nba_matrix, cluster_cols=FALSE)


###Spearman correlation


require(ggpubr)
require(tidyverse)
require(Hmisc)
require(corrplot)
library("pheatmap")
library(ggpubr)



matrix_a <- Taxa
matrix_b <- Open


##Aeromonadaceae
M1Aeromonadaceae <- cor.test(matrix_a$Aeromonadaceae, matrix_b$sidt2, method=c("spearman"))
M1Aeromonadaceae

M2Aeromonadaceae <- cor.test(matrix_a$Aeromonadaceae, matrix_b$rabep2, method=c("spearman"))
M2Aeromonadaceae

M3Aeromonadaceae <- cor.test(matrix_a$Aeromonadaceae, matrix_b$ffar2, method=c("spearman"))
M3Aeromonadaceae

M4Aeromonadaceae <- cor.test(matrix_a$Aeromonadaceae, matrix_b$aifm3, method=c("spearman"))
M4Aeromonadaceae

M5Aeromonadaceae <- cor.test(matrix_a$Aeromonadaceae, matrix_b$ub, method=c("spearman"))
M5Aeromonadaceae

M6Aeromonadaceae <- cor.test(matrix_a$Aeromonadaceae, matrix_b$dspa2b, method=c("spearman"))
M6Aeromonadaceae

M7Aeromonadaceae <- cor.test(matrix_a$Aeromonadaceae, matrix_b$tmem38b, method=c("spearman"))
M7Aeromonadaceae

M8Aeromonadaceae <- cor.test(matrix_a$Aeromonadaceae, matrix_b$manf, method=c("spearman"))
M8Aeromonadaceae

M9Aeromonadaceae <- cor.test(matrix_a$Aeromonadaceae, matrix_b$prmt3, method=c("spearman"))
M9Aeromonadaceae


####Bifidobacteriaceae
M1Bifidobacteriaceae <- cor.test(matrix_a$Bifidobacteriaceae, matrix_b$sidt2, method=c("spearman"))
M1Bifidobacteriaceae

M2Bifidobacteriaceae <- cor.test(matrix_a$Bifidobacteriaceae, matrix_b$rabep2, method=c("spearman"))
M2Bifidobacteriaceae

M3Bifidobacteriaceae <- cor.test(matrix_a$Bifidobacteriaceae, matrix_b$ffar2, method=c("spearman"))
M3Bifidobacteriaceae

M4Bifidobacteriaceae <- cor.test(matrix_a$Bifidobacteriaceae, matrix_b$aifm3, method=c("spearman"))
M4Bifidobacteriaceae

M5Bifidobacteriaceae <- cor.test(matrix_a$Bifidobacteriaceae, matrix_b$ub, method=c("spearman"))
M5Bifidobacteriaceae

M6Bifidobacteriaceae <- cor.test(matrix_a$Bifidobacteriaceae, matrix_b$dspa2b, method=c("spearman"))
M6Bifidobacteriaceae

M7Bifidobacteriaceae <- cor.test(matrix_a$Bifidobacteriaceae, matrix_b$tmem38b, method=c("spearman"))
M7Bifidobacteriaceae

M8Bifidobacteriaceae <- cor.test(matrix_a$Bifidobacteriaceae, matrix_b$manf, method=c("spearman"))
M8Bifidobacteriaceae

M9Bifidobacteriaceae <- cor.test(matrix_a$Bifidobacteriaceae, matrix_b$prmt3, method=c("spearman"))
M9Bifidobacteriaceae


###Desulfovibrionaceae
M1Desulfovibrionaceae <- cor.test(matrix_a$Desulfovibrionaceae, matrix_b$sidt2, method=c("spearman"))
M1Desulfovibrionaceae

M2Desulfovibrionaceae <- cor.test(matrix_a$Desulfovibrionaceae, matrix_b$rabep2, method=c("spearman"))
M2Desulfovibrionaceae

M3Desulfovibrionaceae <- cor.test(matrix_a$Desulfovibrionaceae, matrix_b$ffar2, method=c("spearman"))
M3Desulfovibrionaceae

M4Desulfovibrionaceae <- cor.test(matrix_a$Desulfovibrionaceae, matrix_b$aifm3, method=c("spearman"))
M4Desulfovibrionaceae

M5Desulfovibrionaceae <- cor.test(matrix_a$Desulfovibrionaceae, matrix_b$ub, method=c("spearman"))
M5Desulfovibrionaceae

M6Desulfovibrionaceae <- cor.test(matrix_a$Desulfovibrionaceae, matrix_b$dspa2b, method=c("spearman"))
M6Desulfovibrionaceae

M7Desulfovibrionaceae <- cor.test(matrix_a$Desulfovibrionaceae, matrix_b$tmem38b, method=c("spearman"))
M7Desulfovibrionaceae

M8Desulfovibrionaceae <- cor.test(matrix_a$Desulfovibrionaceae, matrix_b$manf, method=c("spearman"))
M8Desulfovibrionaceae

M9Desulfovibrionaceae <- cor.test(matrix_a$Desulfovibrionaceae, matrix_b$prmt3, method=c("spearman"))
M9Desulfovibrionaceae



###Lactobacillaceae
M1Lactobacillaceae <- cor.test(matrix_a$Lactobacillaceae, matrix_b$sidt2, method=c("spearman"))
M1Lactobacillaceae

M2Lactobacillaceae <- cor.test(matrix_a$Lactobacillaceae, matrix_b$rabep2, method=c("spearman"))
M2Lactobacillaceae

M3Lactobacillaceae <- cor.test(matrix_a$Lactobacillaceae, matrix_b$ffar2, method=c("spearman"))
M3Lactobacillaceae

M4Lactobacillaceae <- cor.test(matrix_a$Lactobacillaceae, matrix_b$aifm3, method=c("spearman"))
M4Lactobacillaceae

M5Lactobacillaceae <- cor.test(matrix_a$Lactobacillaceae, matrix_b$ub, method=c("spearman"))
M5Lactobacillaceae

M6Lactobacillaceae <- cor.test(matrix_a$Lactobacillaceae, matrix_b$dspa2b, method=c("spearman"))
M6Lactobacillaceae

M7Lactobacillaceae <- cor.test(matrix_a$Lactobacillaceae, matrix_b$tmem38b, method=c("spearman"))
M7Lactobacillaceae

M8Lactobacillaceae <- cor.test(matrix_a$Lactobacillaceae, matrix_b$manf, method=c("spearman"))
M8Lactobacillaceae

M9Lactobacillaceae <- cor.test(matrix_a$Lactobacillaceae, matrix_b$prmt3, method=c("spearman"))
M9Lactobacillaceae






###Mycoplasmataceae
M1Mycoplasmataceae <- cor.test(matrix_a$Mycoplasmataceae, matrix_b$sidt2, method=c("spearman"))
M1Mycoplasmataceae

M2Mycoplasmataceae <- cor.test(matrix_a$Mycoplasmataceae, matrix_b$rabep2, method=c("spearman"))
M2Mycoplasmataceae

M3Mycoplasmataceae <- cor.test(matrix_a$Mycoplasmataceae, matrix_b$ffar2, method=c("spearman"))
M3Mycoplasmataceae

M4Mycoplasmataceae <- cor.test(matrix_a$Mycoplasmataceae, matrix_b$aifm3, method=c("spearman"))
M4Mycoplasmataceae

M5Mycoplasmataceae <- cor.test(matrix_a$Mycoplasmataceae, matrix_b$ub, method=c("spearman"))
M5Mycoplasmataceae

M6Mycoplasmataceae <- cor.test(matrix_a$Mycoplasmataceae, matrix_b$dspa2b, method=c("spearman"))
M6Mycoplasmataceae

M7Mycoplasmataceae <- cor.test(matrix_a$Mycoplasmataceae, matrix_b$tmem38b, method=c("spearman"))
M7Mycoplasmataceae

M8Mycoplasmataceae <- cor.test(matrix_a$Mycoplasmataceae, matrix_b$manf, method=c("spearman"))
M8Mycoplasmataceae

M9Mycoplasmataceae <- cor.test(matrix_a$Mycoplasmataceae, matrix_b$prmt3, method=c("spearman"))
M9Mycoplasmataceae




###Pseudomonadaceae
M1Pseudomonadaceae <- cor.test(matrix_a$Pseudomonadaceae, matrix_b$sidt2, method=c("spearman"))
M1Pseudomonadaceae

M2Pseudomonadaceae <- cor.test(matrix_a$Pseudomonadaceae, matrix_b$rabep2, method=c("spearman"))
M2Pseudomonadaceae

M3Pseudomonadaceae <- cor.test(matrix_a$Pseudomonadaceae, matrix_b$ffar2, method=c("spearman"))
M3Pseudomonadaceae

M4Pseudomonadaceae <- cor.test(matrix_a$Pseudomonadaceae, matrix_b$aifm3, method=c("spearman"))
M4Pseudomonadaceae

M5Pseudomonadaceae <- cor.test(matrix_a$Pseudomonadaceae, matrix_b$ub, method=c("spearman"))
M5Pseudomonadaceae

M6Pseudomonadaceae <- cor.test(matrix_a$Pseudomonadaceae, matrix_b$dspa2b, method=c("spearman"))
M6Pseudomonadaceae

M7Pseudomonadaceae <- cor.test(matrix_a$Pseudomonadaceae, matrix_b$tmem38b, method=c("spearman"))
M7Pseudomonadaceae

M8Pseudomonadaceae <- cor.test(matrix_a$Pseudomonadaceae, matrix_b$manf, method=c("spearman"))
M8Pseudomonadaceae

M9Pseudomonadaceae <- cor.test(matrix_a$Pseudomonadaceae, matrix_b$prmt3, method=c("spearman"))
M9Pseudomonadaceae





###Streptococcaceae
M1Streptococcaceae <- cor.test(matrix_a$Streptococcaceae, matrix_b$sidt2, method=c("spearman"))
M1Streptococcaceae

M2Streptococcaceae <- cor.test(matrix_a$Streptococcaceae, matrix_b$rabep2, method=c("spearman"))
M2Streptococcaceae

M3Streptococcaceae <- cor.test(matrix_a$Streptococcaceae, matrix_b$ffar2, method=c("spearman"))
M3Streptococcaceae

M4Streptococcaceae <- cor.test(matrix_a$Streptococcaceae, matrix_b$aifm3, method=c("spearman"))
M4Streptococcaceae

M5Streptococcaceae <- cor.test(matrix_a$Streptococcaceae, matrix_b$ub, method=c("spearman"))
M5Streptococcaceae

M6Streptococcaceae <- cor.test(matrix_a$Streptococcaceae, matrix_b$dspa2b, method=c("spearman"))
M6Streptococcaceae

M7Streptococcaceae <- cor.test(matrix_a$Streptococcaceae, matrix_b$tmem38b, method=c("spearman"))
M7Streptococcaceae

M8Streptococcaceae <- cor.test(matrix_a$Streptococcaceae, matrix_b$manf, method=c("spearman"))
M8Streptococcaceae

M9Streptococcaceae <- cor.test(matrix_a$Streptococcaceae, matrix_b$prmt3, method=c("spearman"))
M9Streptococcaceae

#Figure 5
